# 每日学习报告 - 2026-02-13

## 📚 今日学习主题：DCF 估值模型工具开发

### 学习目标
探索和投资相关的技能缺口，开发实用的 DCF（贴现现金流）估值工具。

### 技能缺口分析

**现有投资技能盘点：**
| 技能 | 状态 | 说明 |
|------|------|------|
| stock-quote | ✅ 已有 | 实时行情查询 |
| friday-report-sync | ✅ 已有 | 报告同步到服务器 |
| gemini-deep-research | ✅ 已有 | 深度研究分析 |
| dcf-valuation | 🆕 新增 | DCF 估值模型 |

**识别到的缺口：**
- ✅ DCF 绝对估值工具（今日完成）
- ⏳ 相对估值工具（P/E, P/B, EV/EBITDA 对比）
- ⏳ 财报数据自动化获取
- ⏳ 技术分析指标
- ⏳ 投资组合追踪

---

## 🔧 实现过程

### 1. 技术选型
- **语言**: Python 3（无需额外依赖）
- **设计模式**: 不依赖外部 API（避免限流问题）
- **输入方式**: 命令行参数 + 交互模式 + JSON

### 2. 核心功能实现

**DCF 两阶段模型：**
- 显性预测期（默认5年）：基于用户输入的增长率
- 永续增长期：使用 Gordon Growth Model 计算终值

**关键公式：**
```python
# 终值计算
TV = FCF_n × (1+g) / (WACC - g)

# 企业价值
EV = Σ(FCF_t / (1+WACC)^t) + TV / (1+WACC)^n

# 每股价值
Value_per_share = (EV - Net_Debt) / Shares
```

**敏感性分析：**
- WACC 变化范围：±2%（步长1%）
- 永续增长率变化范围：±1%（步长1%）
- 输出5×3估值矩阵

### 3. 代码结构
```
dcf-valuation/
├── dcf-valuation (主脚本，可执行)
└── SKILL.md (文档)
```

**代码特点：**
- 使用 dataclass 管理输入参数
- 模块化的计算方法（便于单元测试）
- 友好的格式化输出
- JSON 输出支持程序化调用

### 4. 测试验证

**微软 (MSFT) 估值测试：**
```bash
dcf-valuation \
  --fcf 65000 \
  --growth-5y 0.12 \
  --growth-terminal 0.025 \
  --wacc 0.09 \
  --shares 7430 \
  --current-price 415
```

**测试结果：**
- 每股内在价值: $205.50
- 当前价格: $415.00
- 结论: 在当前假设下高估 50.5%
- 敏感性矩阵显示 WACC 8%、永续增长 3.5% 时估值 $290

**交互模式测试：** ✅ 通过
**JSON 输出测试：** ✅ 通过

---

## 🎯 学习收获

### 技术收获
1. **DCF 模型原理**: 深入理解了两阶段估值法的计算流程
2. **Python dataclass**: 学习使用 dataclass 简化数据管理
3. **敏感性分析**: 理解了估值对关键假设的敏感性
4. **CLI 设计**: 实践了友好的命令行工具设计

### 投资知识收获
1. **估值敏感性**: 
   - WACC 从 9% 降到 7%，估值提升约 46%
   - 永续增长从 2.5% 提升到 3.5%，估值提升约 15%
   
2. **安全边际重要性**: 
   - 输入假设的微小变化会导致估值大幅波动
   - 需要保留 20-30% 安全边际

3. **数据源局限**: 
   - Yahoo Finance 限流严重，不适合自动化
   - 不依赖 API 的设计更稳定

### 遇到的问题及解决

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| Yahoo Finance 限流 | API 调用频率限制 | 改为用户输入参数模式 |
| FCF 单位混淆 | 百万 vs 十亿 | 明确标注单位为"百万美元" |
| 公式验证 | 需要对照标准 DCF 方法 | 参考 Tidy Finance 和 GitHub 开源实现 |

---

## 📁 交付物

### 新增技能文件
```
~/.openclaw/skills/dcf-valuation/
├── dcf-valuation (主脚本，382行，可执行)
└── SKILL.md (文档，182行)
```

### 使用示例
```bash
# 添加到 PATH
ln -sf ~/.openclaw/skills/dcf-valuation/dcf-valuation ~/.local/bin/dcf-valuation

# 交互模式
dcf-valuation --interactive

# 直接调用
python3 ~/.openclaw/skills/dcf-valuation/dcf-valuation --interactive
```

---

## 📋 下一步学习计划

### 短期（1-2周）
1. **相对估值工具**: 开发 P/E、P/B、EV/EBITDA 对比分析工具
2. **估值报告生成**: 结合 dcf-valuation + Gemini 生成完整报告
3. **美股财报数据**: 探索稳定的财务数据获取方案

### 中期（1月内）
1. **投资组合追踪**: 持仓成本、收益、风险分析
2. **行业估值库**: 建立不同行业的合理估值区间数据库
3. **自动化更新**: 定时更新持仓股票估值

---

## 💡 经验总结

### 成功要素
1. **先搜索再实现**: 阅读了 Tidy Finance 等高质量资源
2. **不依赖外部 API**: 避免因限流导致工具不可用
3. **多种输入方式**: 支持交互、命令行、JSON 三种模式
4. **完整性**: 包含估值、敏感性分析、投资建议

### 改进空间
1. **财务数据获取**: 需要寻找稳定的数据源（可能付费）
2. **自动化程度**: 目前需要手动输入参数
3. **可视化**: 可以增加折线图展示 FCF 预测

---

*记录时间: 2026-02-13 00:00+08:00*
*下次学习: 相对估值工具开发*
